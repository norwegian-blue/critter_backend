"use strict";(self["webpackChunkcritter_frontend"]=self["webpackChunkcritter_frontend"]||[]).push([[722],{722:function(e,t,s){s.r(t),s.d(t,{default:function(){return Te}});var a=s(3396),r=s(7139);const i=e=>((0,a.dD)("data-v-d27332d8"),e=e(),(0,a.Cn)(),e),o={class:"card card-container"},n=i((()=>(0,a._)("h2",{class:"title my-2 mx-auto"},"Post a Creet",-1))),d={class:"card card-container"},l=i((()=>(0,a._)("h2",{class:"title my-2 mx-auto"},"Feed",-1))),c={key:0,class:"alert alert-danger",role:"alert"},h=i((()=>(0,a._)("img",{class:"img-fluid mx-auto",id:"post-img",src:"forestDance.jpg",style:{width:"70%",height:"70%"}},null,-1))),u={class:"container mx-0 my-3 px-1 py-0 rounded",style:{"background-color":"#fbfbfb"}},m={class:"row"};function g(e,t,s,i,g,p){const w=(0,a.up)("CreetModal"),C=(0,a.up)("Creet"),b=(0,a.up)("Pagination");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a._)("div",o,[n,(0,a._)("button",{class:"btn btn-secondary mb-2 mx-auto",style:{width:"25%"},onClick:t[0]||(t[0]=(...e)=>p.toggleModal&&p.toggleModal(...e))},"Create"),(0,a.Wm)(w,{showModal:g.showCreetModal,onCloseModal:p.closeModal,onPosted:p.updateFeed},null,8,["showModal","onCloseModal","onPosted"])]),(0,a._)("div",d,[l,g.message?((0,a.wg)(),(0,a.iD)("div",c,(0,r.zw)(g.message),1)):(0,a.kq)("",!0),h,(0,a._)("div",u,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(g.creets,(e=>((0,a.wg)(),(0,a.j4)(C,{key:e.creetId,creet:e,onUpdated:t[1]||(t[1]=e=>p.updateFeed())},null,8,["creet"])))),128))])]),(0,a._)("div",m,[(0,a.Wm)(b,{pages:g.pages,pageNum:g.currentPage,onPageUpd:t[2]||(t[2]=e=>{this.currentPage=e,this.updateFeed()})},null,8,["pages","pageNum"])])],64)}var p=s(9242);const w={class:"card p-0 mb-4"},C={class:"card-header row mx-0 p-2"},b={class:"col-xs-6 font-weight-bold"},_={class:"col-xs-6 ml-auto text-right font-italic"},v={class:"card-body p-2 border-0"},k=["innerHTML"],y={key:0,class:"card reCreet mt-3"},M={class:"card-header reCreet font-weight-bold text-right"},f={class:"card-body reCreet"},P=["innerHTML"],x={class:"card-footer p-2 border-0"},$={class:"row mx-0"},D={class:"col-xs-3 mr-2"},F={class:"col-xs-3"},N={class:"col-xs-3"},Z=["disabled"],L={class:"col-xs-2 my-auto ml-auto"},z={class:"col-xs-4 mx-2"},U=["disabled"],I={class:"ml-2 spinner-border spinner-border-sm"},O={class:"row"},T={key:0,class:"alert alert-danger mx-auto mt-3 mb-2 p-2 fade show",role:"alert"};function q(e,t,s,i,o,n){const d=(0,a.up)("CreetModal"),l=(0,a.up)("font-awesome-icon");return(0,a.wg)(),(0,a.iD)("div",w,[(0,a._)("div",C,[(0,a._)("div",b,(0,r.zw)(s.creet.user.alias),1),(0,a._)("div",_,(0,r.zw)(this.dateAndTime),1)]),(0,a._)("div",v,[(0,a._)("span",{style:{"white-space":"pre-wrap"},innerHTML:this.creetFmt(this.creet.content)},null,8,k),this.creet.reCreet?((0,a.wg)(),(0,a.iD)("div",y,[(0,a._)("div",M,(0,r.zw)(s.creet.reCreet.user.alias),1),(0,a._)("div",f,[(0,a._)("span",{style:{"white-space":"pre-wrap"},innerHTML:this.creetFmt(s.creet.reCreet.content)},null,8,P)])])):(0,a.kq)("",!0)]),(0,a._)("div",x,[(0,a._)("div",$,[(0,a.wy)((0,a._)("div",D,[(0,a.Wm)(d,{showModal:o.showEditModal,editCreet:this.creet,onCloseModal:t[0]||(t[0]=e=>o.showEditModal=!1),onPosted:t[1]||(t[1]=e=>this.$emit("updated"))},null,8,["showModal","editCreet"]),(0,a._)("button",{class:"btn btn-sm mx-auto",onClick:t[2]||(t[2]=e=>o.showEditModal=!0)},"Edit")],512),[[p.F8,this.isOwner]]),(0,a.wy)((0,a._)("div",F,[(0,a._)("button",{class:"btn btn-sm ml-auto",onClick:t[3]||(t[3]=(...e)=>n.deleteCreet&&n.deleteCreet(...e))},"Delete")],512),[[p.F8,this.isOwner]]),(0,a.wy)((0,a._)("div",N,[(0,a.Wm)(d,{showModal:o.showRecreetModal,reCreet:this.creet,onCloseModal:t[4]||(t[4]=e=>o.showRecreetModal=!1),onPosted:t[5]||(t[5]=e=>this.$emit("updated"))},null,8,["showModal","reCreet"]),(0,a._)("button",{class:"btn btn-sm mx-auto",disabled:this.creet.reCreet,onClick:t[6]||(t[6]=e=>o.showRecreetModal=!0)},"Re-creet",8,Z)],512),[[p.F8,!this.isOwner]]),(0,a._)("div",L," Likes: "+(0,r.zw)(this.likes),1),(0,a._)("div",z,[(0,a._)("button",{class:"btn btn-sm",disabled:!this.canLike,onClick:t[7]||(t[7]=(...e)=>n.upvote&&n.upvote(...e))},[(0,a.Wm)(l,{icon:"ice-cream"})],8,U),(0,a.wy)((0,a._)("span",I,null,512),[[p.F8,o.loading]])])]),(0,a._)("div",O,[o.message?((0,a.wg)(),(0,a.iD)("div",T,(0,r.zw)(o.message),1)):(0,a.kq)("",!0)])])])}var H=s(1006),R=s(8);const j="/api/creets";class E{postCreet(e){return H.Z.post(j+"/",{content:e},{headers:(0,R.Z)()})}getFeed(e,t){return H.Z.get(`${j}?page=${e}&size=${t}`,{headers:(0,R.Z)()})}deleteCreet(e){return H.Z["delete"](`${j}/${e}`,{headers:(0,R.Z)()})}editCreet(e,t){return H.Z.put(`${j}/${e}`,{content:t},{headers:(0,R.Z)()})}repostCreet(e,t){return H.Z.post(`${j}/recreet/${e}`,{content:t},{headers:(0,R.Z)()})}upvoteCreet(e){return H.Z.post(`${j}/upvote/${e}`,{},{headers:(0,R.Z)()})}}var S=new E;const W=e=>((0,a.dD)("data-v-c6ec028c"),e=e(),(0,a.Cn)(),e),A={class:"modal-dialog",role:"document"},B={class:"modal-content"},Y={class:"modal-header"},G={class:"modal-title title"},K={key:0},V={key:1},J={key:2},Q=W((()=>(0,a._)("span",{"aria-hidden":"true"},"Ã—",-1))),X=[Q],ee={class:"modal-body py-0"},te=W((()=>(0,a._)("div",{class:"row my-3"},[(0,a._)("img",{class:"img-fluid mx-auto",id:"post-img",src:"bunnyLetter.jpeg",style:{width:"40%"}})],-1))),se={class:"row m-3"},ae={key:0,class:"row m-3"},re={class:"card"},ie={class:"card-header font-weight-bold text-right pl-auto"},oe={class:"card-body"},ne={key:1,class:"alert alert-danger m-3 fade show",role:"alert"},de={class:"modal-footer"},le=["disabled"],ce={class:"spinner-border spinner-border-sm"},he=W((()=>(0,a._)("span",null,"Submit",-1))),ue={key:0,class:"modal-backdrop fade show"};function me(e,t,s,i,o,n){return(0,a.wg)(),(0,a.j4)(a.lR,{to:"body"},[(0,a._)("div",{ref:"modal",class:(0,r.C_)(["modal fade",{show:o.active,"d-block":o.active}]),tabindex:"-1",role:"dialog"},[(0,a._)("div",A,[(0,a._)("div",B,[(0,a._)("div",Y,[(0,a._)("h4",G,[this.editCreet?((0,a.wg)(),(0,a.iD)("span",K,"Edit Creet")):this.reCreet?((0,a.wg)(),(0,a.iD)("span",V,"Repost Creet")):((0,a.wg)(),(0,a.iD)("span",J,"Post a new Creet"))]),(0,a._)("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close",onClick:t[0]||(t[0]=e=>n.closeModal())},X)]),(0,a._)("div",ee,[te,(0,a._)("div",se,[(0,a.wy)((0,a._)("textarea",{name:"content",type:"text","onUpdate:modelValue":t[1]||(t[1]=e=>o.content=e),rows:"3",autocomplete:"off",class:"form-control",placeholder:"Insert content"},null,512),[[p.nr,o.content]])]),this.reCreet?((0,a.wg)(),(0,a.iD)("div",ae,[(0,a._)("div",re,[(0,a._)("div",ie,(0,r.zw)(this.reCreet.user.username),1),(0,a._)("div",oe,(0,r.zw)(this.reCreet.content),1)])])):(0,a.kq)("",!0),o.message?((0,a.wg)(),(0,a.iD)("div",ne,(0,r.zw)(o.message),1)):(0,a.kq)("",!0)]),(0,a._)("div",de,[(0,a._)("button",{type:"button",class:"btn btn-danger",onClick:t[2]||(t[2]=e=>n.closeModal())},"Close"),(0,a._)("button",{type:"button",class:"btn btn-secondary",disabled:o.loading,onClick:t[3]||(t[3]=(...e)=>n.submitCreet&&n.submitCreet(...e))},[(0,a.wy)((0,a._)("span",ce,null,512),[[p.F8,o.loading]]),he],8,le)])])])],2),o.active?((0,a.wg)(),(0,a.iD)("div",ue)):(0,a.kq)("",!0)])}var ge={name:"CreetModal",emits:["closeModal","posted"],props:{showModal:Boolean,editCreet:Object,reCreet:Object},watch:{showModal:{handler(e){this.editCreet&&(this.content=this.editCreet.content),this.active=e;const t=document.querySelector("body");this.showModal?t.classList.add("modal-open"):t.classList.remove("modal-open")},immediate:!0,deep:!0}},data(){return{active:this.showModal,content:"",loading:!1,message:""}},methods:{closeModal(){this.message="",this.loading=!1,this.$emit("closeModal")},submitCreet(){if(this.loading=!0,!this.content)return this.loading=!1,void(this.message="Content cannot be empty!");let e;e=this.editCreet?this.editOldCreet:this.reCreet?this.repostCreet:this.postNewCreet,e().then((()=>{this.loading=!1,this.$emit("posted"),this.editCreet||(this.content=""),this.$emit("closeModal")})).catch((e=>{this.loading=!1,this.editCreet?this.content=this.editCreet.content:this.content="",this.message=e.response&&e.response.data&&e.response.data.message||e.message||e.toString()}))},postNewCreet(){return S.postCreet(this.content)},editOldCreet(){return S.editCreet(this.editCreet.id,this.content)},repostCreet(){return S.repostCreet(this.reCreet.id,this.content)}}},pe=s(89);const we=(0,pe.Z)(ge,[["render",me],["__scopeId","data-v-c6ec028c"]]);var Ce=we,be={name:"Creet",components:{CreetModal:Ce},props:["creet"],emits:["updated"],data(){return{showEditModal:!1,showRecreetModal:!1,message:"",loading:!1}},computed:{dateAndTime(){const e=new Date(this.creet.createdAt),t=new Intl.DateTimeFormat("en-GB",{weekday:"short",day:"2-digit",year:"numeric",month:"long",hour:"numeric",minute:"numeric"});return t.format(e)},currentUser(){return this.$store.state.auth.user},isOwner(){return!!this.currentUser&&this.creet.user.id===this.currentUser.id},likes(){return this.creet.likes.length},canLike(){if(!this.currentUser)return!1;const e=this.creet.likes.map((e=>e.id===this.currentUser.id)).reduce(((e,t)=>e||t),!1);return!this.isOwner&&!e}},methods:{creetFmt(e){let t=e.replace(/(#[^\s]+)/g,"<b>$1</b>");return t.replace(/\n/g,"<br/>")},deleteCreet(){confirm("Do you really want to delete this creet?")&&S.deleteCreet(this.creet.id).then((()=>{this.$emit("updated")})).catch((e=>{this.message=e.response&&e.response.data&&e.response.data.message||e.message||e.toString(),setTimeout((()=>{this.message=""}),1e3)}))},upvote(){this.canLike&&(this.loading=!0,S.upvoteCreet(this.creet.id).then((()=>{this.loading=!1,this.$emit("updated")})).catch((e=>{this.loading=!1,this.message=e.response&&e.response.data&&e.response.data.message||e.message||e.toString(),setTimeout((()=>{this.message=""}),1e3)})))}}};const _e=(0,pe.Z)(be,[["render",q],["__scopeId","data-v-7ebb9533"]]);var ve=_e;const ke=e=>((0,a.dD)("data-v-dcc6e734"),e=e(),(0,a.Cn)(),e),ye={class:"mx-auto","aria-label":"Page navigation example"},Me={class:"pagination"},fe=ke((()=>(0,a._)("a",{class:"page-link",href:"#","aria-label":"First"},[(0,a._)("span",{"aria-hidden":"true"},"Â«")],-1))),Pe=[fe],xe={class:"page-link",href:"#"},$e={class:"page-link",href:"#"},De={class:"page-link",href:"#"},Fe=ke((()=>(0,a._)("a",{class:"page-link",href:"#","aria-label":"Last"},[(0,a._)("span",{"aria-hidden":"true"},"Â»")],-1))),Ne=[Fe];function Ze(e,t,s,i,o,n){return(0,a.wg)(),(0,a.iD)("nav",ye,[(0,a._)("ul",Me,[(0,a._)("li",{class:"page-item",onClick:t[0]||(t[0]=e=>this.clickPage(0))},Pe),(0,a._)("li",{class:(0,r.C_)(["page-item",{active:this.currentPage==this.pgNum[0]}]),onClick:t[1]||(t[1]=e=>this.clickPage(this.pgNum[0]))},[(0,a._)("a",xe,(0,r.zw)(this.pgNum[0]),1)],2),(0,a.wy)((0,a._)("li",{class:(0,r.C_)(["page-item",{active:this.currentPage==this.pgNum[1]}]),onClick:t[2]||(t[2]=e=>this.clickPage(this.pgNum[1]))},[(0,a._)("a",$e,(0,r.zw)(this.pgNum[1]),1)],2),[[p.F8,this.pgNum[1]>0]]),(0,a.wy)((0,a._)("li",{class:(0,r.C_)(["page-item",{active:this.currentPage==this.pgNum[2]}]),onClick:t[3]||(t[3]=e=>this.clickPage(this.pgNum[2]))},[(0,a._)("a",De,(0,r.zw)(this.pgNum[2]),1)],2),[[p.F8,this.pgNum[2]>0]]),(0,a._)("li",{class:"page-item",onClick:t[4]||(t[4]=e=>this.clickPage(-1))},Ne)])])}var Le={name:"Pagination",emit:["pageUpd"],props:{pages:Number,pageNum:Number},data(){return{currentPage:1}},computed:{pgNum(){let e=this.currentPage>1?[-1,0,1].map((e=>e+this.currentPage)):[1,2,3];return e=this.currentPage<this.pages?e:[-2,-1,0].map((e=>e+this.pages)),2===this.pages&&(e=[1,2,0]),1===this.pages&&(e=[1,0,0]),e}},mounted(){this.currentPage=this.pageNum},methods:{clickPage(e){this.currentPage=0===e?1:-1===e?this.pages:e,this.$emit("pageUpd",this.currentPage)}}};const ze=(0,pe.Z)(Le,[["render",Ze],["__scopeId","data-v-dcc6e734"]]);var Ue=ze,Ie={name:"Home",data(){return{creets:[],message:"",showCreetModal:!1,currentPage:1,pages:1,creetsPerPage:5}},components:{Creet:ve,CreetModal:Ce,Pagination:Ue},mounted(){if(!this.$store.state.auth.status.loggedIn)return this.$router.push("/Landing");this.updateFeed()},updated(){if(!this.$store.state.auth.status.loggedIn)return this.$router.push("/Landing")},methods:{updateFeed(){S.getFeed(this.currentPage,this.creetsPerPage).then((e=>{this.message="",this.creets=e.data.creets,this.pages=e.data.totalPages,console.log(this.creets)})).catch((e=>{this.message=e.response&&e.response.data&&e.response.data.message||e.message||e.toString()}))},closeModal(){this.showCreetModal=!1},toggleModal(){this.showCreetModal=!this.showCreetModal}}};const Oe=(0,pe.Z)(Ie,[["render",g],["__scopeId","data-v-d27332d8"]]);var Te=Oe}}]);
//# sourceMappingURL=722.c0e764e6.js.map