"use strict";(self["webpackChunkcritter_frontend"]=self["webpackChunkcritter_frontend"]||[]).push([[328],{5328:function(e,t,s){s.r(t),s.d(t,{default:function(){return Ie}});var a=s(3396),r=s(7139);const i=e=>((0,a.dD)("data-v-d027ec6e"),e=e(),(0,a.Cn)(),e),o={class:"card card-container"},n=i((()=>(0,a._)("h2",{class:"title my-2 mx-auto"},"Post a Creet",-1))),d={class:"card card-container"},l=i((()=>(0,a._)("h2",{class:"title my-2 mx-auto"},"Feed",-1))),c={key:0,class:"alert alert-danger",role:"alert"},h=i((()=>(0,a._)("img",{class:"img-fluid mx-auto",id:"post-img",src:"forestDance.jpg",style:{width:"70%",height:"70%"}},null,-1))),u={class:"container mx-0 my-3 px-1 py-0 rounded",style:{"background-color":"#fbfbfb"}},m={class:"row"};function g(e,t,s,i,g,p){const C=(0,a.up)("CreetModal"),w=(0,a.up)("Creet"),_=(0,a.up)("Pagination");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a._)("div",o,[n,(0,a._)("button",{class:"btn btn-secondary mb-2 mx-auto",style:{width:"25%"},onClick:t[0]||(t[0]=(...e)=>p.toggleModal&&p.toggleModal(...e))},"Create"),(0,a.Wm)(C,{showModal:g.showCreetModal,onCloseModal:p.closeModal,onPosted:p.updateFeed},null,8,["showModal","onCloseModal","onPosted"])]),(0,a._)("div",d,[l,g.message?((0,a.wg)(),(0,a.iD)("div",c,(0,r.zw)(g.message),1)):(0,a.kq)("",!0),h,(0,a._)("div",u,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(g.creets,(e=>((0,a.wg)(),(0,a.j4)(w,{key:e.creetId,creet:e,onUpdated:t[1]||(t[1]=e=>p.updateFeed())},null,8,["creet"])))),128))])]),(0,a._)("div",m,[(0,a.Wm)(_,{pages:g.pages,pageNum:g.currentPage,onPageUpd:t[2]||(t[2]=e=>{this.currentPage=e,this.updateFeed()})},null,8,["pages","pageNum"])])],64)}var p=s(9242);const C={class:"card p-0 mb-4"},w={class:"card-header row mx-0 p-2"},_={class:"col-xs-6 font-weight-bold"},b={class:"col-xs-6 ml-auto text-right font-italic"},v={class:"card-body p-2 border-0"},k={key:0,class:"card reCreet mt-3"},y={class:"card-header reCreet font-weight-bold text-right"},f={class:"card-body reCreet"},M={class:"card-footer p-2 border-0"},P={class:"row mx-0"},x={class:"col-xs-3 mr-2"},$={class:"col-xs-3"},D={class:"col-xs-3"},N=["disabled"],F={class:"col-xs-2 my-auto ml-auto"},Z={class:"col-xs-4 mx-2"},z=["disabled"],U={class:"ml-2 spinner-border spinner-border-sm"},L={class:"row"},I={key:0,class:"alert alert-danger mx-auto mt-3 mb-2 p-2 fade show",role:"alert"};function O(e,t,s,i,o,n){const d=(0,a.up)("CreetModal"),l=(0,a.up)("font-awesome-icon");return(0,a.wg)(),(0,a.iD)("div",C,[(0,a._)("div",w,[(0,a._)("div",_,(0,r.zw)(s.creet.user.username),1),(0,a._)("div",b,(0,r.zw)(this.dateAndTime),1)]),(0,a._)("div",v,[(0,a.Uk)((0,r.zw)(s.creet.content)+" ",1),this.creet.reCreet?((0,a.wg)(),(0,a.iD)("div",k,[(0,a._)("div",y,(0,r.zw)(s.creet.reCreet.user.username),1),(0,a._)("div",f,(0,r.zw)(s.creet.reCreet.content),1)])):(0,a.kq)("",!0)]),(0,a._)("div",M,[(0,a._)("div",P,[(0,a.wy)((0,a._)("div",x,[(0,a.Wm)(d,{showModal:o.showEditModal,editCreet:this.creet,onCloseModal:t[0]||(t[0]=e=>o.showEditModal=!1),onPosted:t[1]||(t[1]=e=>this.$emit("updated"))},null,8,["showModal","editCreet"]),(0,a._)("button",{class:"btn btn-sm mx-auto",onClick:t[2]||(t[2]=e=>o.showEditModal=!0)},"Edit")],512),[[p.F8,this.isOwner]]),(0,a.wy)((0,a._)("div",$,[(0,a._)("button",{class:"btn btn-sm ml-auto",onClick:t[3]||(t[3]=(...e)=>n.deleteCreet&&n.deleteCreet(...e))},"Delete")],512),[[p.F8,this.isOwner]]),(0,a.wy)((0,a._)("div",D,[(0,a.Wm)(d,{showModal:o.showRecreetModal,reCreet:this.creet,onCloseModal:t[4]||(t[4]=e=>o.showRecreetModal=!1),onPosted:t[5]||(t[5]=e=>this.$emit("updated"))},null,8,["showModal","reCreet"]),(0,a._)("button",{class:"btn btn-sm mx-auto",disabled:this.creet.reCreet,onClick:t[6]||(t[6]=e=>o.showRecreetModal=!0)},"Re-creet",8,N)],512),[[p.F8,!this.isOwner]]),(0,a._)("div",F," Likes: "+(0,r.zw)(this.likes),1),(0,a._)("div",Z,[(0,a._)("button",{class:"btn btn-sm",disabled:!this.canLike,onClick:t[7]||(t[7]=(...e)=>n.upvote&&n.upvote(...e))},[(0,a.Wm)(l,{icon:"ice-cream"})],8,z),(0,a.wy)((0,a._)("span",U,null,512),[[p.F8,o.loading]])])]),(0,a._)("div",L,[o.message?((0,a.wg)(),(0,a.iD)("div",I,(0,r.zw)(o.message),1)):(0,a.kq)("",!0)])])])}var q=s(1006),R=s(8);const j="http://localhost:8080/api/creets";class E{postCreet(e){return q.Z.post(j+"/",{content:e},{headers:(0,R.Z)()})}getFeed(e,t){return q.Z.get(`${j}?page=${e}&size=${t}`,{headers:(0,R.Z)()})}deleteCreet(e){return q.Z["delete"](`${j}/${e}`,{headers:(0,R.Z)()})}editCreet(e,t){return q.Z.put(`${j}/${e}`,{content:t},{headers:(0,R.Z)()})}repostCreet(e,t){return q.Z.post(`${j}/recreet/${e}`,{content:t},{headers:(0,R.Z)()})}upvoteCreet(e){return q.Z.post(`${j}/upvote/${e}`,{},{headers:(0,R.Z)()})}}var S=new E;const T=e=>((0,a.dD)("data-v-c6ec028c"),e=e(),(0,a.Cn)(),e),W={class:"modal-dialog",role:"document"},A={class:"modal-content"},H={class:"modal-header"},B={class:"modal-title title"},Y={key:0},G={key:1},K={key:2},V=T((()=>(0,a._)("span",{"aria-hidden":"true"},"×",-1))),J=[V],Q={class:"modal-body py-0"},X=T((()=>(0,a._)("div",{class:"row my-3"},[(0,a._)("img",{class:"img-fluid mx-auto",id:"post-img",src:"bunnyLetter.jpeg",style:{width:"40%"}})],-1))),ee={class:"row m-3"},te={key:0,class:"row m-3"},se={class:"card"},ae={class:"card-header font-weight-bold text-right pl-auto"},re={class:"card-body"},ie={key:1,class:"alert alert-danger m-3 fade show",role:"alert"},oe={class:"modal-footer"},ne=["disabled"],de={class:"spinner-border spinner-border-sm"},le=T((()=>(0,a._)("span",null,"Submit",-1))),ce={key:0,class:"modal-backdrop fade show"};function he(e,t,s,i,o,n){return(0,a.wg)(),(0,a.j4)(a.lR,{to:"body"},[(0,a._)("div",{ref:"modal",class:(0,r.C_)(["modal fade",{show:o.active,"d-block":o.active}]),tabindex:"-1",role:"dialog"},[(0,a._)("div",W,[(0,a._)("div",A,[(0,a._)("div",H,[(0,a._)("h4",B,[this.editCreet?((0,a.wg)(),(0,a.iD)("span",Y,"Edit Creet")):this.reCreet?((0,a.wg)(),(0,a.iD)("span",G,"Repost Creet")):((0,a.wg)(),(0,a.iD)("span",K,"Post a new Creet"))]),(0,a._)("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close",onClick:t[0]||(t[0]=e=>n.closeModal())},J)]),(0,a._)("div",Q,[X,(0,a._)("div",ee,[(0,a.wy)((0,a._)("textarea",{name:"content",type:"text","onUpdate:modelValue":t[1]||(t[1]=e=>o.content=e),rows:"3",autocomplete:"off",class:"form-control",placeholder:"Insert content"},null,512),[[p.nr,o.content]])]),this.reCreet?((0,a.wg)(),(0,a.iD)("div",te,[(0,a._)("div",se,[(0,a._)("div",ae,(0,r.zw)(this.reCreet.user.username),1),(0,a._)("div",re,(0,r.zw)(this.reCreet.content),1)])])):(0,a.kq)("",!0),o.message?((0,a.wg)(),(0,a.iD)("div",ie,(0,r.zw)(o.message),1)):(0,a.kq)("",!0)]),(0,a._)("div",oe,[(0,a._)("button",{type:"button",class:"btn btn-danger",onClick:t[2]||(t[2]=e=>n.closeModal())},"Close"),(0,a._)("button",{type:"button",class:"btn btn-secondary",disabled:o.loading,onClick:t[3]||(t[3]=(...e)=>n.submitCreet&&n.submitCreet(...e))},[(0,a.wy)((0,a._)("span",de,null,512),[[p.F8,o.loading]]),le],8,ne)])])])],2),o.active?((0,a.wg)(),(0,a.iD)("div",ce)):(0,a.kq)("",!0)])}var ue={name:"CreetModal",emits:["closeModal","posted"],props:{showModal:Boolean,editCreet:Object,reCreet:Object},watch:{showModal:{handler(e){this.editCreet&&(this.content=this.editCreet.content),this.active=e;const t=document.querySelector("body");this.showModal?t.classList.add("modal-open"):t.classList.remove("modal-open")},immediate:!0,deep:!0}},data(){return{active:this.showModal,content:"",loading:!1,message:""}},methods:{closeModal(){this.message="",this.loading=!1,this.$emit("closeModal")},submitCreet(){if(this.loading=!0,!this.content)return this.loading=!1,void(this.message="Content cannot be empty!");let e;e=this.editCreet?this.editOldCreet:this.reCreet?this.repostCreet:this.postNewCreet,e().then((()=>{this.loading=!1,this.$emit("posted"),this.editCreet||(this.content=""),this.$emit("closeModal")})).catch((e=>{this.loading=!1,this.editCreet?this.content=this.editCreet.content:this.content="",this.message=e.response&&e.response.data&&e.response.data.message||e.message||e.toString()}))},postNewCreet(){return S.postCreet(this.content)},editOldCreet(){return S.editCreet(this.editCreet.id,this.content)},repostCreet(){return S.repostCreet(this.reCreet.id,this.content)}}},me=s(89);const ge=(0,me.Z)(ue,[["render",he],["__scopeId","data-v-c6ec028c"]]);var pe=ge,Ce={name:"Creet",components:{CreetModal:pe},props:["creet"],emits:["updated"],data(){return{showEditModal:!1,showRecreetModal:!1,message:"",loading:!1}},computed:{dateAndTime(){const e=new Date(this.creet.createdAt),t=new Intl.DateTimeFormat("en-GB",{weekday:"short",day:"2-digit",year:"numeric",month:"long",hour:"numeric",minute:"numeric"});return t.format(e)},currentUser(){return this.$store.state.auth.user},isOwner(){return!!this.currentUser&&this.creet.user.id===this.currentUser.id},likes(){return this.creet.likes.length},canLike(){if(!this.currentUser)return!1;const e=this.creet.likes.map((e=>e.id===this.currentUser.id)).reduce(((e,t)=>e||t),!1);return!this.isOwner&&!e}},methods:{deleteCreet(){confirm("Do you really want to delete this creet?")&&S.deleteCreet(this.creet.id).then((()=>{this.$emit("updated")})).catch((e=>{this.message=e.response&&e.response.data&&e.response.data.message||e.message||e.toString(),setTimeout((()=>{this.message=""}),1e3)}))},upvote(){this.canLike&&(this.loading=!0,S.upvoteCreet(this.creet.id).then((()=>{this.loading=!1,this.$emit("updated")})).catch((e=>{this.loading=!1,this.message=e.response&&e.response.data&&e.response.data.message||e.message||e.toString(),setTimeout((()=>{this.message=""}),1e3)})))}}};const we=(0,me.Z)(Ce,[["render",O],["__scopeId","data-v-789832f8"]]);var _e=we;const be=e=>((0,a.dD)("data-v-dcc6e734"),e=e(),(0,a.Cn)(),e),ve={class:"mx-auto","aria-label":"Page navigation example"},ke={class:"pagination"},ye=be((()=>(0,a._)("a",{class:"page-link",href:"#","aria-label":"First"},[(0,a._)("span",{"aria-hidden":"true"},"«")],-1))),fe=[ye],Me={class:"page-link",href:"#"},Pe={class:"page-link",href:"#"},xe={class:"page-link",href:"#"},$e=be((()=>(0,a._)("a",{class:"page-link",href:"#","aria-label":"Last"},[(0,a._)("span",{"aria-hidden":"true"},"»")],-1))),De=[$e];function Ne(e,t,s,i,o,n){return(0,a.wg)(),(0,a.iD)("nav",ve,[(0,a._)("ul",ke,[(0,a._)("li",{class:"page-item",onClick:t[0]||(t[0]=e=>this.clickPage(0))},fe),(0,a._)("li",{class:(0,r.C_)(["page-item",{active:this.currentPage==this.pgNum[0]}]),onClick:t[1]||(t[1]=e=>this.clickPage(this.pgNum[0]))},[(0,a._)("a",Me,(0,r.zw)(this.pgNum[0]),1)],2),(0,a.wy)((0,a._)("li",{class:(0,r.C_)(["page-item",{active:this.currentPage==this.pgNum[1]}]),onClick:t[2]||(t[2]=e=>this.clickPage(this.pgNum[1]))},[(0,a._)("a",Pe,(0,r.zw)(this.pgNum[1]),1)],2),[[p.F8,this.pgNum[1]>0]]),(0,a.wy)((0,a._)("li",{class:(0,r.C_)(["page-item",{active:this.currentPage==this.pgNum[2]}]),onClick:t[3]||(t[3]=e=>this.clickPage(this.pgNum[2]))},[(0,a._)("a",xe,(0,r.zw)(this.pgNum[2]),1)],2),[[p.F8,this.pgNum[2]>0]]),(0,a._)("li",{class:"page-item",onClick:t[4]||(t[4]=e=>this.clickPage(-1))},De)])])}var Fe={name:"Pagination",emit:["pageUpd"],props:{pages:Number,pageNum:Number},data(){return{currentPage:1}},computed:{pgNum(){let e=this.currentPage>1?[-1,0,1].map((e=>e+this.currentPage)):[1,2,3];return e=this.currentPage<this.pages?e:[-2,-1,0].map((e=>e+this.pages)),2===this.pages&&(e=[1,2,0]),1===this.pages&&(e=[1,0,0]),e}},mounted(){this.currentPage=this.pageNum},methods:{clickPage(e){this.currentPage=0===e?1:-1===e?this.pages:e,this.$emit("pageUpd",this.currentPage)}}};const Ze=(0,me.Z)(Fe,[["render",Ne],["__scopeId","data-v-dcc6e734"]]);var ze=Ze,Ue={name:"Home",data(){return{creets:[],message:"",showCreetModal:!1,currentPage:1,pages:1,creetsPerPage:5}},components:{Creet:_e,CreetModal:pe,Pagination:ze},mounted(){if(!this.$store.state.auth.status.loggedIn)return this.$router.push("/Landing");this.updateFeed()},updated(){if(!this.$store.state.auth.status.loggedIn)return this.$router.push("/Landing")},methods:{updateFeed(){S.getFeed(this.currentPage,this.creetsPerPage).then((e=>{this.message="",this.creets=e.data.creets,this.pages=e.data.totalPages})).catch((e=>{this.message=e.response&&e.response.data&&e.response.data.message||e.message||e.toString()}))},closeModal(){this.showCreetModal=!1},toggleModal(){this.showCreetModal=!this.showCreetModal}}};const Le=(0,me.Z)(Ue,[["render",g],["__scopeId","data-v-d027ec6e"]]);var Ie=Le}}]);
//# sourceMappingURL=328.913a2001.js.map